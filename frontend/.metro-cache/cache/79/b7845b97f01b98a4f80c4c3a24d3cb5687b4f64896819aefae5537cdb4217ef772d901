{"dependencies":[{"name":"../constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":50,"index":65}}],"key":"eTOOXVNPpMK2U8dOAmBWjbEJ4yE=","exportNames":["*"]}},{"name":"../interfaces","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":66},"end":{"line":4,"column":43,"index":109}}],"key":"GMKh3a5g5xNaAog15vl07v6pG2U=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _constants = require(_dependencyMap[0], \"../constants\");\n  var _interfaces = require(_dependencyMap[1], \"../interfaces\");\n  class ScaleGestureDetector {\n    inProgress = false;\n    constructor(callbacks) {\n      this.onScaleBegin = callbacks.onScaleBegin;\n      this.onScale = callbacks.onScale;\n      this.onScaleEnd = callbacks.onScaleEnd;\n      this.spanSlop = _constants.DEFAULT_TOUCH_SLOP * 2;\n      this.minSpan = 0;\n    }\n    onTouchEvent(event, tracker) {\n      this.currentTime = event.time;\n      const action = event.eventType;\n      const numOfPointers = tracker.trackedPointersCount;\n      const streamComplete = action === _interfaces.EventTypes.UP || action === _interfaces.EventTypes.ADDITIONAL_POINTER_UP || action === _interfaces.EventTypes.CANCEL;\n      if (action === _interfaces.EventTypes.DOWN || streamComplete) {\n        if (this.inProgress) {\n          this.onScaleEnd(this);\n          this.inProgress = false;\n          this.initialSpan = 0;\n        }\n        if (streamComplete) {\n          return true;\n        }\n      }\n      const configChanged = action === _interfaces.EventTypes.DOWN || action === _interfaces.EventTypes.ADDITIONAL_POINTER_UP || action === _interfaces.EventTypes.ADDITIONAL_POINTER_DOWN;\n      const pointerUp = action === _interfaces.EventTypes.ADDITIONAL_POINTER_UP;\n      const ignoredPointer = pointerUp ? event.pointerId : undefined;\n\n      // Determine focal point\n\n      const div = pointerUp ? numOfPointers - 1 : numOfPointers;\n      const coordsSum = tracker.getAbsoluteCoordsSum();\n      const focusX = coordsSum.x / div;\n      const focusY = coordsSum.y / div;\n\n      // Determine average deviation from focal point\n\n      let devSumX = 0;\n      let devSumY = 0;\n      tracker.trackedPointers.forEach((value, key) => {\n        if (key === ignoredPointer) {\n          return;\n        }\n        devSumX += Math.abs(value.abosoluteCoords.x - focusX);\n        devSumY += Math.abs(value.abosoluteCoords.y - focusY);\n      });\n      const devX = devSumX / div;\n      const devY = devSumY / div;\n      const spanX = devX * 2;\n      const spanY = devY * 2;\n      const span = Math.hypot(spanX, spanY);\n\n      // Begin/end events\n      const wasInProgress = this.inProgress;\n      this._focusX = focusX;\n      this._focusY = focusY;\n      if (this.inProgress && (span < this.minSpan || configChanged)) {\n        this.onScaleEnd(this);\n        this.inProgress = false;\n        this.initialSpan = span;\n      }\n      if (configChanged) {\n        this.initialSpan = this.prevSpan = this._currentSpan = span;\n      }\n      if (!this.inProgress && span >= this.minSpan && (wasInProgress || Math.abs(span - this.initialSpan) > this.spanSlop)) {\n        this.prevSpan = this._currentSpan = span;\n        this.prevTime = this.currentTime;\n        this.inProgress = this.onScaleBegin(this);\n      }\n\n      // Handle motion\n      if (action !== _interfaces.EventTypes.MOVE) {\n        return true;\n      }\n      this._currentSpan = span;\n      if (this.inProgress && !this.onScale(this)) {\n        return true;\n      }\n      this.prevSpan = this.currentSpan;\n      this.prevTime = this.currentTime;\n      return true;\n    }\n    calculateScaleFactor(numOfPointers) {\n      if (numOfPointers < 2) {\n        return 1;\n      }\n      return this.prevSpan > 0 ? this.currentSpan / this.prevSpan : 1;\n    }\n    get currentSpan() {\n      return this._currentSpan;\n    }\n    get focusX() {\n      return this._focusX;\n    }\n    get focusY() {\n      return this._focusY;\n    }\n    get timeDelta() {\n      return this.currentTime - this.prevTime;\n    }\n  }\n  exports.default = ScaleGestureDetector;\n});","lineCount":112,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13,"Object"],[4,8,1,13],[4,9,1,13,"defineProperty"],[4,23,1,13],[4,24,1,13,"exports"],[4,31,1,13],[5,4,1,13,"value"],[5,9,1,13],[6,2,1,13],[7,2,1,13,"exports"],[7,9,1,13],[7,10,1,13,"default"],[7,17,1,13],[8,2,3,0],[8,6,3,0,"_constants"],[8,16,3,0],[8,19,3,0,"require"],[8,26,3,0],[8,27,3,0,"_dependencyMap"],[8,41,3,0],[9,2,4,0],[9,6,4,0,"_interfaces"],[9,17,4,0],[9,20,4,0,"require"],[9,27,4,0],[9,28,4,0,"_dependencyMap"],[9,42,4,0],[10,2,5,15],[10,8,5,21,"ScaleGestureDetector"],[10,28,5,41],[10,29,5,42],[11,4,6,2,"inProgress"],[11,14,6,12],[11,17,6,15],[11,22,6,20],[12,4,7,2,"constructor"],[12,15,7,13,"constructor"],[12,16,7,14,"callbacks"],[12,25,7,23],[12,27,7,25],[13,6,8,4],[13,10,8,8],[13,11,8,9,"onScaleBegin"],[13,23,8,21],[13,26,8,24,"callbacks"],[13,35,8,33],[13,36,8,34,"onScaleBegin"],[13,48,8,46],[14,6,9,4],[14,10,9,8],[14,11,9,9,"onScale"],[14,18,9,16],[14,21,9,19,"callbacks"],[14,30,9,28],[14,31,9,29,"onScale"],[14,38,9,36],[15,6,10,4],[15,10,10,8],[15,11,10,9,"onScaleEnd"],[15,21,10,19],[15,24,10,22,"callbacks"],[15,33,10,31],[15,34,10,32,"onScaleEnd"],[15,44,10,42],[16,6,11,4],[16,10,11,8],[16,11,11,9,"spanSlop"],[16,19,11,17],[16,22,11,20,"DEFAULT_TOUCH_SLOP"],[16,51,11,38],[16,54,11,41],[16,55,11,42],[17,6,12,4],[17,10,12,8],[17,11,12,9,"minSpan"],[17,18,12,16],[17,21,12,19],[17,22,12,20],[18,4,13,2],[19,4,14,2,"onTouchEvent"],[19,16,14,14,"onTouchEvent"],[19,17,14,15,"event"],[19,22,14,20],[19,24,14,22,"tracker"],[19,31,14,29],[19,33,14,31],[20,6,15,4],[20,10,15,8],[20,11,15,9,"currentTime"],[20,22,15,20],[20,25,15,23,"event"],[20,30,15,28],[20,31,15,29,"time"],[20,35,15,33],[21,6,16,4],[21,12,16,10,"action"],[21,18,16,16],[21,21,16,19,"event"],[21,26,16,24],[21,27,16,25,"eventType"],[21,36,16,34],[22,6,17,4],[22,12,17,10,"numOfPointers"],[22,25,17,23],[22,28,17,26,"tracker"],[22,35,17,33],[22,36,17,34,"trackedPointersCount"],[22,56,17,54],[23,6,18,4],[23,12,18,10,"streamComplete"],[23,26,18,24],[23,29,18,27,"action"],[23,35,18,33],[23,40,18,38,"EventTypes"],[23,62,18,48],[23,63,18,49,"UP"],[23,65,18,51],[23,69,18,55,"action"],[23,75,18,61],[23,80,18,66,"EventTypes"],[23,102,18,76],[23,103,18,77,"ADDITIONAL_POINTER_UP"],[23,124,18,98],[23,128,18,102,"action"],[23,134,18,108],[23,139,18,113,"EventTypes"],[23,161,18,123],[23,162,18,124,"CANCEL"],[23,168,18,130],[24,6,19,4],[24,10,19,8,"action"],[24,16,19,14],[24,21,19,19,"EventTypes"],[24,43,19,29],[24,44,19,30,"DOWN"],[24,48,19,34],[24,52,19,38,"streamComplete"],[24,66,19,52],[24,68,19,54],[25,8,20,6],[25,12,20,10],[25,16,20,14],[25,17,20,15,"inProgress"],[25,27,20,25],[25,29,20,27],[26,10,21,8],[26,14,21,12],[26,15,21,13,"onScaleEnd"],[26,25,21,23],[26,26,21,24],[26,30,21,28],[26,31,21,29],[27,10,22,8],[27,14,22,12],[27,15,22,13,"inProgress"],[27,25,22,23],[27,28,22,26],[27,33,22,31],[28,10,23,8],[28,14,23,12],[28,15,23,13,"initialSpan"],[28,26,23,24],[28,29,23,27],[28,30,23,28],[29,8,24,6],[30,8,25,6],[30,12,25,10,"streamComplete"],[30,26,25,24],[30,28,25,26],[31,10,26,8],[31,17,26,15],[31,21,26,19],[32,8,27,6],[33,6,28,4],[34,6,29,4],[34,12,29,10,"configChanged"],[34,25,29,23],[34,28,29,26,"action"],[34,34,29,32],[34,39,29,37,"EventTypes"],[34,61,29,47],[34,62,29,48,"DOWN"],[34,66,29,52],[34,70,29,56,"action"],[34,76,29,62],[34,81,29,67,"EventTypes"],[34,103,29,77],[34,104,29,78,"ADDITIONAL_POINTER_UP"],[34,125,29,99],[34,129,29,103,"action"],[34,135,29,109],[34,140,29,114,"EventTypes"],[34,162,29,124],[34,163,29,125,"ADDITIONAL_POINTER_DOWN"],[34,186,29,148],[35,6,30,4],[35,12,30,10,"pointerUp"],[35,21,30,19],[35,24,30,22,"action"],[35,30,30,28],[35,35,30,33,"EventTypes"],[35,57,30,43],[35,58,30,44,"ADDITIONAL_POINTER_UP"],[35,79,30,65],[36,6,31,4],[36,12,31,10,"ignoredPointer"],[36,26,31,24],[36,29,31,27,"pointerUp"],[36,38,31,36],[36,41,31,39,"event"],[36,46,31,44],[36,47,31,45,"pointerId"],[36,56,31,54],[36,59,31,57,"undefined"],[36,68,31,66],[38,6,33,4],[40,6,35,4],[40,12,35,10,"div"],[40,15,35,13],[40,18,35,16,"pointerUp"],[40,27,35,25],[40,30,35,28,"numOfPointers"],[40,43,35,41],[40,46,35,44],[40,47,35,45],[40,50,35,48,"numOfPointers"],[40,63,35,61],[41,6,36,4],[41,12,36,10,"coordsSum"],[41,21,36,19],[41,24,36,22,"tracker"],[41,31,36,29],[41,32,36,30,"getAbsoluteCoordsSum"],[41,52,36,50],[41,53,36,51],[41,54,36,52],[42,6,37,4],[42,12,37,10,"focusX"],[42,18,37,16],[42,21,37,19,"coordsSum"],[42,30,37,28],[42,31,37,29,"x"],[42,32,37,30],[42,35,37,33,"div"],[42,38,37,36],[43,6,38,4],[43,12,38,10,"focusY"],[43,18,38,16],[43,21,38,19,"coordsSum"],[43,30,38,28],[43,31,38,29,"y"],[43,32,38,30],[43,35,38,33,"div"],[43,38,38,36],[45,6,40,4],[47,6,42,4],[47,10,42,8,"devSumX"],[47,17,42,15],[47,20,42,18],[47,21,42,19],[48,6,43,4],[48,10,43,8,"devSumY"],[48,17,43,15],[48,20,43,18],[48,21,43,19],[49,6,44,4,"tracker"],[49,13,44,11],[49,14,44,12,"trackedPointers"],[49,29,44,27],[49,30,44,28,"forEach"],[49,37,44,35],[49,38,44,36],[49,39,44,37,"value"],[49,44,44,42],[49,46,44,44,"key"],[49,49,44,47],[49,54,44,52],[50,8,45,6],[50,12,45,10,"key"],[50,15,45,13],[50,20,45,18,"ignoredPointer"],[50,34,45,32],[50,36,45,34],[51,10,46,8],[52,8,47,6],[53,8,48,6,"devSumX"],[53,15,48,13],[53,19,48,17,"Math"],[53,23,48,21],[53,24,48,22,"abs"],[53,27,48,25],[53,28,48,26,"value"],[53,33,48,31],[53,34,48,32,"abosoluteCoords"],[53,49,48,47],[53,50,48,48,"x"],[53,51,48,49],[53,54,48,52,"focusX"],[53,60,48,58],[53,61,48,59],[54,8,49,6,"devSumY"],[54,15,49,13],[54,19,49,17,"Math"],[54,23,49,21],[54,24,49,22,"abs"],[54,27,49,25],[54,28,49,26,"value"],[54,33,49,31],[54,34,49,32,"abosoluteCoords"],[54,49,49,47],[54,50,49,48,"y"],[54,51,49,49],[54,54,49,52,"focusY"],[54,60,49,58],[54,61,49,59],[55,6,50,4],[55,7,50,5],[55,8,50,6],[56,6,51,4],[56,12,51,10,"devX"],[56,16,51,14],[56,19,51,17,"devSumX"],[56,26,51,24],[56,29,51,27,"div"],[56,32,51,30],[57,6,52,4],[57,12,52,10,"devY"],[57,16,52,14],[57,19,52,17,"devSumY"],[57,26,52,24],[57,29,52,27,"div"],[57,32,52,30],[58,6,53,4],[58,12,53,10,"spanX"],[58,17,53,15],[58,20,53,18,"devX"],[58,24,53,22],[58,27,53,25],[58,28,53,26],[59,6,54,4],[59,12,54,10,"spanY"],[59,17,54,15],[59,20,54,18,"devY"],[59,24,54,22],[59,27,54,25],[59,28,54,26],[60,6,55,4],[60,12,55,10,"span"],[60,16,55,14],[60,19,55,17,"Math"],[60,23,55,21],[60,24,55,22,"hypot"],[60,29,55,27],[60,30,55,28,"spanX"],[60,35,55,33],[60,37,55,35,"spanY"],[60,42,55,40],[60,43,55,41],[62,6,57,4],[63,6,58,4],[63,12,58,10,"wasInProgress"],[63,25,58,23],[63,28,58,26],[63,32,58,30],[63,33,58,31,"inProgress"],[63,43,58,41],[64,6,59,4],[64,10,59,8],[64,11,59,9,"_focusX"],[64,18,59,16],[64,21,59,19,"focusX"],[64,27,59,25],[65,6,60,4],[65,10,60,8],[65,11,60,9,"_focusY"],[65,18,60,16],[65,21,60,19,"focusY"],[65,27,60,25],[66,6,61,4],[66,10,61,8],[66,14,61,12],[66,15,61,13,"inProgress"],[66,25,61,23],[66,30,61,28,"span"],[66,34,61,32],[66,37,61,35],[66,41,61,39],[66,42,61,40,"minSpan"],[66,49,61,47],[66,53,61,51,"configChanged"],[66,66,61,64],[66,67,61,65],[66,69,61,67],[67,8,62,6],[67,12,62,10],[67,13,62,11,"onScaleEnd"],[67,23,62,21],[67,24,62,22],[67,28,62,26],[67,29,62,27],[68,8,63,6],[68,12,63,10],[68,13,63,11,"inProgress"],[68,23,63,21],[68,26,63,24],[68,31,63,29],[69,8,64,6],[69,12,64,10],[69,13,64,11,"initialSpan"],[69,24,64,22],[69,27,64,25,"span"],[69,31,64,29],[70,6,65,4],[71,6,66,4],[71,10,66,8,"configChanged"],[71,23,66,21],[71,25,66,23],[72,8,67,6],[72,12,67,10],[72,13,67,11,"initialSpan"],[72,24,67,22],[72,27,67,25],[72,31,67,29],[72,32,67,30,"prevSpan"],[72,40,67,38],[72,43,67,41],[72,47,67,45],[72,48,67,46,"_currentSpan"],[72,60,67,58],[72,63,67,61,"span"],[72,67,67,65],[73,6,68,4],[74,6,69,4],[74,10,69,8],[74,11,69,9],[74,15,69,13],[74,16,69,14,"inProgress"],[74,26,69,24],[74,30,69,28,"span"],[74,34,69,32],[74,38,69,36],[74,42,69,40],[74,43,69,41,"minSpan"],[74,50,69,48],[74,55,69,53,"wasInProgress"],[74,68,69,66],[74,72,69,70,"Math"],[74,76,69,74],[74,77,69,75,"abs"],[74,80,69,78],[74,81,69,79,"span"],[74,85,69,83],[74,88,69,86],[74,92,69,90],[74,93,69,91,"initialSpan"],[74,104,69,102],[74,105,69,103],[74,108,69,106],[74,112,69,110],[74,113,69,111,"spanSlop"],[74,121,69,119],[74,122,69,120],[74,124,69,122],[75,8,70,6],[75,12,70,10],[75,13,70,11,"prevSpan"],[75,21,70,19],[75,24,70,22],[75,28,70,26],[75,29,70,27,"_currentSpan"],[75,41,70,39],[75,44,70,42,"span"],[75,48,70,46],[76,8,71,6],[76,12,71,10],[76,13,71,11,"prevTime"],[76,21,71,19],[76,24,71,22],[76,28,71,26],[76,29,71,27,"currentTime"],[76,40,71,38],[77,8,72,6],[77,12,72,10],[77,13,72,11,"inProgress"],[77,23,72,21],[77,26,72,24],[77,30,72,28],[77,31,72,29,"onScaleBegin"],[77,43,72,41],[77,44,72,42],[77,48,72,46],[77,49,72,47],[78,6,73,4],[80,6,75,4],[81,6,76,4],[81,10,76,8,"action"],[81,16,76,14],[81,21,76,19,"EventTypes"],[81,43,76,29],[81,44,76,30,"MOVE"],[81,48,76,34],[81,50,76,36],[82,8,77,6],[82,15,77,13],[82,19,77,17],[83,6,78,4],[84,6,79,4],[84,10,79,8],[84,11,79,9,"_currentSpan"],[84,23,79,21],[84,26,79,24,"span"],[84,30,79,28],[85,6,80,4],[85,10,80,8],[85,14,80,12],[85,15,80,13,"inProgress"],[85,25,80,23],[85,29,80,27],[85,30,80,28],[85,34,80,32],[85,35,80,33,"onScale"],[85,42,80,40],[85,43,80,41],[85,47,80,45],[85,48,80,46],[85,50,80,48],[86,8,81,6],[86,15,81,13],[86,19,81,17],[87,6,82,4],[88,6,83,4],[88,10,83,8],[88,11,83,9,"prevSpan"],[88,19,83,17],[88,22,83,20],[88,26,83,24],[88,27,83,25,"currentSpan"],[88,38,83,36],[89,6,84,4],[89,10,84,8],[89,11,84,9,"prevTime"],[89,19,84,17],[89,22,84,20],[89,26,84,24],[89,27,84,25,"currentTime"],[89,38,84,36],[90,6,85,4],[90,13,85,11],[90,17,85,15],[91,4,86,2],[92,4,87,2,"calculateScaleFactor"],[92,24,87,22,"calculateScaleFactor"],[92,25,87,23,"numOfPointers"],[92,38,87,36],[92,40,87,38],[93,6,88,4],[93,10,88,8,"numOfPointers"],[93,23,88,21],[93,26,88,24],[93,27,88,25],[93,29,88,27],[94,8,89,6],[94,15,89,13],[94,16,89,14],[95,6,90,4],[96,6,91,4],[96,13,91,11],[96,17,91,15],[96,18,91,16,"prevSpan"],[96,26,91,24],[96,29,91,27],[96,30,91,28],[96,33,91,31],[96,37,91,35],[96,38,91,36,"currentSpan"],[96,49,91,47],[96,52,91,50],[96,56,91,54],[96,57,91,55,"prevSpan"],[96,65,91,63],[96,68,91,66],[96,69,91,67],[97,4,92,2],[98,4,93,2],[98,8,93,6,"currentSpan"],[98,19,93,17,"currentSpan"],[98,20,93,17],[98,22,93,20],[99,6,94,4],[99,13,94,11],[99,17,94,15],[99,18,94,16,"_currentSpan"],[99,30,94,28],[100,4,95,2],[101,4,96,2],[101,8,96,6,"focusX"],[101,14,96,12,"focusX"],[101,15,96,12],[101,17,96,15],[102,6,97,4],[102,13,97,11],[102,17,97,15],[102,18,97,16,"_focusX"],[102,25,97,23],[103,4,98,2],[104,4,99,2],[104,8,99,6,"focusY"],[104,14,99,12,"focusY"],[104,15,99,12],[104,17,99,15],[105,6,100,4],[105,13,100,11],[105,17,100,15],[105,18,100,16,"_focusY"],[105,25,100,23],[106,4,101,2],[107,4,102,2],[107,8,102,6,"timeDelta"],[107,17,102,15,"timeDelta"],[107,18,102,15],[107,20,102,18],[108,6,103,4],[108,13,103,11],[108,17,103,15],[108,18,103,16,"currentTime"],[108,29,103,27],[108,32,103,30],[108,36,103,34],[108,37,103,35,"prevTime"],[108,45,103,43],[109,4,104,2],[110,2,105,0],[111,2,105,1,"exports"],[111,9,105,1],[111,10,105,1,"default"],[111,17,105,1],[111,20,105,1,"ScaleGestureDetector"],[111,40,105,1],[112,0,105,1],[112,3]],"functionMap":{"names":["<global>","ScaleGestureDetector","constructor","onTouchEvent","tracker.trackedPointers.forEach$argument_0","calculateScaleFactor","get__currentSpan","get__focusX","get__focusY","get__timeDelta"],"mappings":"AAA;eCI;ECE;GDM;EEC;oCC8B;KDM;GFoC;EIC;GJK;EKC;GLE;EMC;GNE;EOC;GPE;EQC;GRE;CDC"}},"type":"js/module"}]}